<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–µ–º–æ–Ω—Ç–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f5f5f5; }
        .card { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        input, select, button { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #ddd; box-sizing: border-box; }
        button { background: #d35400; color: white; border: none; font-weight: bold; cursor: pointer; font-size: 16px; }
        .row { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #eee; padding: 10px 0; }
        h2 { text-align: center; color: #333; }
        #total { text-align: center; font-size: 24px; font-weight: bold; color: #d35400; margin: 20px 0; }
    </style>
</head>
<body>

<div class="card">
    <h2>–¢–µ—Å—Ç —Å–º–µ—Ç—ã</h2>
    
    <label>–ü–ª–æ—â–∞–¥—å (–º¬≤)</label>
    <input type="number" id="area" value="50" oninput="calc()">

    <label>–ö–æ–º–Ω–∞—Ç—ã</label>
    <select id="rooms">
        <option value="1">1-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
        <option value="2">2-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
    </select>

    <h3>–†–∞–±–æ—Ç—ã:</h3>
    <div class="row">
        <span>–®–ø–∞—Ç–ª–µ–≤–∫–∞ (470—Ä)</span>
        <input type="checkbox" id="work1" onchange="calc()">
    </div>
    <div class="row">
        <span>–ü–æ–∫—Ä–∞—Å–∫–∞ (450—Ä)</span>
        <input type="checkbox" id="work2" onchange="calc()">
    </div>

    <div id="total">0 ‚ÇΩ</div>
    <button onclick="sendData()">üì§ –û–¢–ü–†–ê–í–ò–¢–¨ –°–ú–ï–¢–£</button>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    function calc() {
        let sum = 0;
        const area = document.getElementById('area').value || 0;
        
        // –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è —Ç–µ—Å—Ç–∞
        if(document.getElementById('work1').checked) sum += 470 * area;
        if(document.getElementById('work2').checked) sum += 450 * area;

        document.getElementById('total').innerText = sum + " ‚ÇΩ";
        return sum;
    }

    function sendData() {
        const area = document.getElementById('area').value;
        const total = document.getElementById('total').innerText;
        
        // –°–æ–±–∏—Ä–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ä–∞–±–æ—Ç
        let items = [];
        if(document.getElementById('work1').checked) {
            items.push({name: "–®–ø–∞—Ç–ª–µ–≤–∫–∞", price: 470, qty: area, unit: "–º2"});
        }
        if(document.getElementById('work2').checked) {
            items.push({name: "–ü–æ–∫—Ä–∞—Å–∫–∞", price: 450, qty: area, unit: "–º2"});
        }

        if(items.length === 0) {
            tg.showPopup({title: '–û—à–∏–±–∫–∞', message: '–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Ä–∞–±–æ—Ç—É'});
            return;
        }

        // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ JSON –¥–ª—è Python
        const data = {
            area: area,
            rooms: document.getElementById('rooms').value,
            repair: "–¢–µ—Å—Ç–æ–≤—ã–π —Ä–∞—Å—á–µ—Ç",
            total: total,
            items: items
        };

        // –û—Ç–ø—Ä–∞–≤–∫–∞
        tg.sendData(JSON.stringify(data));
    }
</script>

</body>
</html>