<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–¢–æ—á–Ω—ã–π —Ä–∞—Å—á—ë—Ç —Ä–µ–º–æ–Ω—Ç–∞ ‚Äî FinishPerfekt</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f9f9f9;
      padding: 16px;
      margin: 0;
      color: #333;
    }
    .card {
      background: white;
      border-radius: 16px;
      padding: 20px;
      margin: 12px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }
    h2 {
      font-size: 20px;
      margin: 0 0 16px;
    }
    label {
      display: block;
      margin: 12px 0 6px;
      font-weight: 600;
    }
    input, select {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 16px;
      box-sizing: border-box;
    }
    .checkbox-group {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-top: 8px;
    }
    .checkbox-item {
      flex: 1 1 45%;
      min-width: 140px;
    }
    .checkbox-item label {
      margin: 0;
      font-weight: normal;
      display: flex;
      align-items: center;
      cursor: pointer;
    }
    .checkbox-item input[type="checkbox"] {
      width: auto;
      margin-right: 8px;
    }
    .checkbox-item input[type="number"] {
      margin-top: 4px;
      width: 80px;
      display: block;
    }
    #result {
      font-size: 18px;
      font-weight: bold;
      color: #0088cc;
      margin: 16px 0;
      padding: 12px;
      background: #eef7ff;
      border-radius: 10px;
    }
    button {
      background: #0088cc;
      color: white;
      border: none;
      padding: 16px;
      border-radius: 12px;
      font-size: 18px;
      width: 100%;
      font-weight: 600;
      margin-top: 10px;
    }
    .btn-contact {
      background: #25D366;
      margin-top: 10px;
    }
    .section {
      border-top: 1px solid #eee;
      padding-top: 16px;
    }
    .section-title {
      font-weight: bold;
      margin: 16px 0 8px;
      color: #333;
    }
    .price-note {
      font-size: 12px;
      color: #666;
      margin-top: 2px;
    }
    .tab-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin: 16px 0;
    }
    .tab-button {
      padding: 12px 16px;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 8px;
      cursor: pointer;
      text-align: center;
      flex: 1 1 200px;
      min-width: 120px;
    }
    .tab-button.active {
      background: #0088cc;
      color: white;
    }
  </style>
</head>
<body>
  <div class="card">
    <h2>üßÆ –¢–æ—á–Ω—ã–π —Ä–∞—Å—á—ë—Ç —Ä–µ–º–æ–Ω—Ç–∞</h2>

    <label>–ü–ª–æ—â–∞–¥—å –∫–≤–∞—Ä—Ç–∏—Ä—ã (–º¬≤):</label>
    <input type="number" id="area" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 52" min="20" max="200" value="52">

    <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–Ω–∞—Ç:</label>
    <select id="rooms">
      <option value="1">1-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
      <option value="2" selected>2-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
      <option value="3">3-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
    </select>

    <label>–¢–∏–ø —Ä–µ–º–æ–Ω—Ç–∞:</label>
    <select id="repairType">
      <option value="cosmetic">–ö–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏–π</option>
      <option value="capital" selected>–ö–∞–ø–∏—Ç–∞–ª—å–Ω—ã–π</option>
      <option value="euro">–ï–≤—Ä–æ / –î–∏–∑–∞–π–Ω–µ—Ä—Å–∫–∏–π</option>
    </select>

    <div class="tab-buttons">
      <div class="tab-button active" onclick="showSection('ceiling')">–ú–æ–Ω—Ç–∞–∂ –ø–æ—Ç–æ–ª–∫–æ–≤</div>
      <div class="tab-button" onclick="showSection('walls')">–ú–æ–Ω—Ç–∞–∂ —Å—Ç–µ–Ω</div>
      <div class="tab-button" onclick="showSection('demolition')">–î–µ–º–æ–Ω—Ç–∞–∂ —Å—Ç–µ–Ω</div>
      <div class="tab-button" onclick="showSection('floor')">–ú–æ–Ω—Ç–∞–∂ –ø–æ–ª–æ–≤</div>
      <div class="tab-button" onclick="showSection('gypsum')">–†–∞–±–æ—Ç—ã —Å –≥–∏–ø—Å–æ–∫–∞—Ä—Ç–æ–Ω–æ–º</div>
      <div class="tab-button" onclick="showSection('kafel')">–ú–æ–Ω—Ç–∞–∂ –∫–∞—Ñ–µ–ª—è</div>
      <div class="tab-button" onclick="showSection('decoration')">–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç</div>
      <div class="tab-button" onclick="showSection('electrical')">–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–Ω—ã–µ —Ä–∞–±–æ—Ç—ã</div>
      <div class="tab-button" onclick="showSection('sanitary')">–ú–æ–Ω—Ç–∞–∂ —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∏</div>
      <div class="tab-button" onclick="showSection('doors')">–ú–æ–Ω—Ç–∞–∂ –¥–≤–µ—Ä–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π</div>
      <div class="tab-button" onclick="showSection('other')">–°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ—á–∏—Ö —Ä–∞–±–æ—Ç</div>
    </div>

    <div id="works"></div>

    <div id="result">–°–º–µ—Ç–∞ –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å</div>

    <button onclick="sendData()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–º–µ—Ç—É –º–µ–Ω–µ–¥–∂–µ—Ä—É</button>
    <button class="btn-contact" onclick="callMaster()">
      üìû –°–≤—è–∑–∞—Ç—å—Å—è —Å –º–∞—Å—Ç–µ—Ä–æ–º
    </button>
  </div>

  <script>
    // === –°–ú–ï–¢–ê: 80 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ä–∞–±–æ—Ç —Å –õ–£–ß–®–ò–ú–ò —Ü–µ–Ω–∞–º–∏ –∏–∑ 8 –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ ===
    const WORKS_DATA = {
      "–ú–æ–Ω—Ç–∞–∂ –ø–æ—Ç–æ–ª–∫–æ–≤": [
        { "name": "–ì—Ä—É–Ω—Ç–æ–≤–∫–∞ –ø–æ—Ç–æ–ª–∫–∞", "unit": "–º¬≤", "price": 60 },
        { "name": "–®–ø–∞—Ç–ª–µ–≤–∫–∞ –ø–æ—Ç–æ–ª–∫–∞ –ø–æ–¥ –ø–æ–∫—Ä–∞—Å–∫—É", "unit": "–º¬≤", "price": 280 },
        { "name": "–ü–æ–∫—Ä–∞—Å–∫–∞ –ø–æ—Ç–æ–ª–∫–∞", "unit": "–º¬≤", "price": 350 },
        { "name": "–ú–æ–Ω—Ç–∞–∂ –ì–ö–õ –Ω–∞ –ø–æ—Ç–æ–ª–æ–∫ (1 —É—Ä–æ–≤–µ–Ω—å)", "unit": "–º¬≤", "price": 700 },
        { "name": "–ú–æ–Ω—Ç–∞–∂ –ì–ö–õ –Ω–∞ –ø–æ—Ç–æ–ª–æ–∫ (2 —É—Ä–æ–≤–Ω—è)", "unit": "–º¬≤", "price": 1000 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—Ç—è–∂–Ω–æ–≥–æ –ø–æ—Ç–æ–ª–∫–∞", "unit": "–º¬≤", "price": 450 }
      ],
      "–ú–æ–Ω—Ç–∞–∂ —Å—Ç–µ–Ω": [
        { "name": "–ì—Ä—É–Ω—Ç–æ–≤–∫–∞ —Å—Ç–µ–Ω", "unit": "–º¬≤", "price": 60 },
        { "name": "–®—Ç—É–∫–∞—Ç—É—Ä–∫–∞ —Å—Ç–µ–Ω –ø–æ –º–∞—è–∫–∞–º", "unit": "–º¬≤", "price": 500 },
        { "name": "–®–ø–∞—Ç–ª–µ–≤–∫–∞ —Å—Ç–µ–Ω –ø–æ–¥ –æ–±–æ–∏", "unit": "–º¬≤", "price": 250 },
        { "name": "–®–ø–∞—Ç–ª–µ–≤–∫–∞ —Å—Ç–µ–Ω –ø–æ–¥ –ø–æ–∫—Ä–∞—Å–∫—É", "unit": "–º¬≤", "price": 300 },
        { "name": "–ü–æ–∫–ª–µ–π–∫–∞ –æ–±–æ–µ–≤ –±–µ–∑ –ø–æ–¥–±–æ—Ä–∞ —Ä–∏—Å—É–Ω–∫–∞", "unit": "–º¬≤", "price": 200 },
        { "name": "–ü–æ–∫–ª–µ–π–∫–∞ –æ–±–æ–µ–≤ —Å –ø–æ–¥–±–æ—Ä–æ–º —Ä–∏—Å—É–Ω–∫–∞", "unit": "–º¬≤", "price": 250 },
        { "name": "–ü–æ–∫—Ä–∞—Å–∫–∞ —Å—Ç–µ–Ω", "unit": "–º¬≤", "price": 220 }
      ],
      "–î–µ–º–æ–Ω—Ç–∞–∂ —Å—Ç–µ–Ω": [
        { "name": "–û—á–∏—Å—Ç–∫–∞ —Å—Ç–µ–Ω –æ—Ç –æ–±–æ–µ–≤", "unit": "–º¬≤", "price": 80 },
        { "name": "–î–µ–º–æ–Ω—Ç–∞–∂ —à—Ç—É–∫–∞—Ç—É—Ä–∫–∏ —Å–æ —Å—Ç–µ–Ω", "unit": "–º¬≤", "price": 135 },
        { "name": "–î–µ–º–æ–Ω—Ç–∞–∂ –ø–ª–∏—Ç–∫–∏ —Å–æ —Å—Ç–µ–Ω", "unit": "–º¬≤", "price": 150 },
        { "name": "–û—á–∏—Å—Ç–∫–∞ —Å—Ç–µ–Ω –æ—Ç –∫—Ä–∞—Å–∫–∏, —à–ø–∞—Ç–ª—ë–≤–∫–∏, –ø–æ–±–µ–ª–∫–∏", "unit": "–º¬≤", "price": 150 },
        { "name": "–î–µ–º–æ–Ω—Ç–∞–∂ –ø–µ—Ä–µ–≥–æ—Ä–æ–¥–æ–∫ –∏–∑ –ì–ö–õ", "unit": "–º¬≤", "price": 160 },
        { "name": "–î–µ–º–æ–Ω—Ç–∞–∂ –ø–µ—Ä–µ–≥–æ—Ä–æ–¥–æ–∫ –∏–∑ –∫–∏—Ä–ø–∏—á–∞", "unit": "–º¬≤", "price": 400 },
        { "name": "–î–µ–º–æ–Ω—Ç–∞–∂ –ø–µ—Ä–µ–≥–æ—Ä–æ–¥–æ–∫ –∏–∑ —Å–∏–±–∏—Ç–∞", "unit": "–º¬≤", "price": 350 }
      ],
      "–ú–æ–Ω—Ç–∞–∂ –ø–æ–ª–æ–≤": [
        { "name": "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å—Ç—è–∂–∫–∏ –ø–æ–ª–∞ (–¥–æ 5 —Å–º)", "unit": "–º¬≤", "price": 400 },
        { "name": "–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ–ª–∞ —Å–∞–º–æ–Ω–∏–≤–µ–ª–∏—Ä–æ–º", "unit": "–º¬≤", "price": 250 },
        { "name": "–£–∫–ª–∞–¥–∫–∞ –ª–∞–º–∏–Ω–∞—Ç–∞", "unit": "–º¬≤", "price": 400 },
        { "name": "–£–∫–ª–∞–¥–∫–∞ –ø–∞—Ä–∫–µ—Ç–Ω–æ–π –¥–æ—Å–∫–∏", "unit": "–º¬≤", "price": 600 },
        { "name": "–£–∫–ª–∞–¥–∫–∞ –ª–∏–Ω–æ–ª–µ—É–º–∞", "unit": "–º¬≤", "price": 250 },
        { "name": "–£–∫–ª–∞–¥–∫–∞ –∫–≤–∞—Ä—Ü–≤–∏–Ω–∏–ª–∞", "unit": "–º¬≤", "price": 380 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞–ø–æ–ª—å–Ω–æ–≥–æ –ø–ª–∏–Ω—Ç—É—Å–∞ (–ø–ª–∞—Å—Ç–∏–∫)", "unit": "–º.–ø.", "price": 100 }
      ],
      "–†–∞–±–æ—Ç—ã —Å –≥–∏–ø—Å–æ–∫–∞—Ä—Ç–æ–Ω–æ–º": [
        { "name": "–ú–æ–Ω—Ç–∞–∂ –ø–µ—Ä–µ–≥–æ—Ä–æ–¥–∫–∏ –∏–∑ –ì–ö–õ (1 —Å–ª–æ–π)", "unit": "–º¬≤", "price": 500 },
        { "name": "–ú–æ–Ω—Ç–∞–∂ –ø–µ—Ä–µ–≥–æ—Ä–æ–¥–∫–∏ –∏–∑ –ì–ö–õ (2 —Å–ª–æ—è)", "unit": "–º¬≤", "price": 600 },
        { "name": "–ú–æ–Ω—Ç–∞–∂ –∫–æ—Ä–æ–±–∞ –∏–∑ –ì–ö–õ", "unit": "–º.–ø.", "price": 800 },
        { "name": "–®–ø–∞—Ç–ª–µ–≤–∫–∞ –ì–ö–õ –ø–æ–¥ –ø–æ–∫—Ä–∞—Å–∫—É", "unit": "–º¬≤", "price": 450 },
        { "name": "–®–ø–∞—Ç–ª–µ–≤–∫–∞ –ì–ö–õ –ø–æ–¥ –æ–±–æ–∏", "unit": "–º¬≤", "price": 300 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–∫–ª–∞–¥–Ω—ã—Ö –ø–æ–¥ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∏", "unit": "—à—Ç", "price": 500 }
      ],
      "–ú–æ–Ω—Ç–∞–∂ –∫–∞—Ñ–µ–ª—è": [
        { "name": "–£–∫–ª–∞–¥–∫–∞ –∫–µ—Ä–∞–º–∏—á–µ—Å–∫–æ–π –ø–ª–∏—Ç–∫–∏ –Ω–∞ —Å—Ç–µ–Ω—ã", "unit": "–º¬≤", "price": 1000 },
        { "name": "–£–∫–ª–∞–¥–∫–∞ –∫–µ—Ä–∞–º–∏—á–µ—Å–∫–æ–π –ø–ª–∏—Ç–∫–∏ –Ω–∞ –ø–æ–ª", "unit": "–º¬≤", "price": 1000 },
        { "name": "–£–∫–ª–∞–¥–∫–∞ –∫–µ—Ä–∞–º–æ–≥—Ä–∞–Ω–∏—Ç–∞ –Ω–∞ –ø–æ–ª", "unit": "–º¬≤", "price": 1200 },
        { "name": "–ó–∞—Ç–∏—Ä–∫–∞ —à–≤–æ–≤ –ø–ª–∏—Ç–∫–∏", "unit": "–º¬≤", "price": 150 },
        { "name": "–ì–∏–¥—Ä–æ–∏–∑–æ–ª—è—Ü–∏—è –ø–æ–ª–∞", "unit": "–º¬≤", "price": 80 }
      ],
      "–°—Ç–æ–∏–º–æ—Å—Ç—å –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Ä–∞–±–æ—Ç": [
        { "name": "–ù–∞–Ω–µ—Å–µ–Ω–∏–µ –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —à—Ç—É–∫–∞—Ç—É—Ä–∫–∏", "unit": "–º¬≤", "price": 500 },
        { "name": "–ù–∞–Ω–µ—Å–µ–Ω–∏–µ –≤–µ–Ω–µ—Ü–∏–∞–Ω—Å–∫–æ–π —à—Ç—É–∫–∞—Ç—É—Ä–∫–∏", "unit": "–º¬≤", "price": 700 },
        { "name": "–û–±–ª–∏—Ü–æ–≤–∫–∞ —Å—Ç–µ–Ω –≤–∞–≥–æ–Ω–∫–æ–π", "unit": "–º¬≤", "price": 450 },
        { "name": "–û–±–ª–∏—Ü–æ–≤–∫–∞ —Å—Ç–µ–Ω –ü–í–• –ø–∞–Ω–µ–ª—è–º–∏", "unit": "–º¬≤", "price": 300 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–µ—Ä–∫–∞–ª–∞", "unit": "—à—Ç", "price": 350 }
      ],
      "–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–Ω—ã–µ —Ä–∞–±–æ—Ç—ã": [
        { "name": "–®—Ç—Ä–æ–±–ª–µ–Ω–∏–µ –≤ –∫–∏—Ä–ø–∏—á–µ", "unit": "–º.–ø.", "price": 100 },
        { "name": "–®—Ç—Ä–æ–±–ª–µ–Ω–∏–µ –≤ –±–µ—Ç–æ–Ω–µ", "unit": "–º.–ø.", "price": 180 },
        { "name": "–ü—Ä–æ–∫–ª–∞–¥–∫–∞ –∫–∞–±–µ–ª—è 3√ó1.5 / 3√ó2.5", "unit": "–º.–ø.", "price": 60 },
        { "name": "–ú–æ–Ω—Ç–∞–∂ —Ä–æ–∑–µ—Ç–∫–∏ / –≤—ã–∫–ª—é—á–∞—Ç–µ–ª—è", "unit": "—à—Ç", "price": 150 },
        { "name": "–ú–æ–Ω—Ç–∞–∂ –ª—é—Å—Ç—Ä—ã", "unit": "—à—Ç", "price": 500 },
        { "name": "–ú–æ–Ω—Ç–∞–∂ —Ç–æ—á–µ—á–Ω–æ–≥–æ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∞", "unit": "—à—Ç", "price": 250 },
        { "name": "–ú–æ–Ω—Ç–∞–∂ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ —â–∏—Ç–∞ (–¥–æ 24 –º–æ–¥)", "unit": "—à—Ç", "price": 2000 }
      ],
      "–ú–æ–Ω—Ç–∞–∂ —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∏": [
        { "name": "–ü—Ä–æ–∫–ª–∞–¥–∫–∞ —Ç—Ä—É–± –≤–æ–¥–æ—Å–Ω–∞–±–∂–µ–Ω–∏—è (–º–µ—Ç–∞–ª–ª–æ–ø–ª–∞—Å—Ç–∏–∫)", "unit": "–º.–ø.", "price": 70 },
        { "name": "–ü—Ä–æ–∫–ª–∞–¥–∫–∞ –∫–∞–Ω–∞–ª–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç—Ä—É–±", "unit": "–º.–ø.", "price": 70 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–º–µ—Å–∏—Ç–µ–ª—è", "unit": "—à—Ç", "price": 300 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —É–Ω–∏—Ç–∞–∑–∞ –Ω–∞–ø–æ–ª—å–Ω–æ–≥–æ", "unit": "—à—Ç", "price": 1000 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —É–Ω–∏—Ç–∞–∑–∞ –ø–æ–¥–≤–µ—Å–Ω–æ–≥–æ", "unit": "—à—Ç", "price": 1500 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä–∞–∫–æ–≤–∏–Ω—ã", "unit": "—à—Ç", "price": 800 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–∞–Ω–Ω—ã", "unit": "—à—Ç", "price": 1200 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥—É—à–µ–≤–æ–π –∫–∞–±–∏–Ω—ã", "unit": "—à—Ç", "price": 2500 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–ª–æ—Ç–µ–Ω—Ü–µ—Å—É—à–∏—Ç–µ–ª—è", "unit": "—à—Ç", "price": 800 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤–æ–¥–æ–Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—è", "unit": "—à—Ç", "price": 1000 },
        { "name": "–ú–æ–Ω—Ç–∞–∂ —Å–∞–Ω—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –ª—é–∫–∞", "unit": "—à—Ç", "price": 250 }
      ],
      "–ú–æ–Ω—Ç–∞–∂ –¥–≤–µ—Ä–Ω—ã—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π": [
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–µ–∂–∫–æ–º–Ω–∞—Ç–Ω–æ–π –¥–≤–µ—Ä–∏ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç)", "unit": "—à—Ç", "price": 3000 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥–æ–∫–æ–Ω–Ω–∏–∫–∞", "unit": "–º.–ø.", "price": 350 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ü–í–• –æ—Ç–∫–æ—Å–æ–≤", "unit": "–º.–ø.", "price": 380 },
        { "name": "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∞—Ä–∫–∏ –∏–∑ –ì–ö–õ", "unit": "—à—Ç", "price": 3000 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–≤–µ—Ä–Ω–æ–≥–æ –∑–∞–º–∫–∞", "unit": "—à—Ç", "price": 1000 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ä—É—á–∫–∏", "unit": "—à—Ç", "price": 600 }
      ],
      "–°—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–æ—á–∏—Ö —Ä–∞–±–æ—Ç": [
        { "name": "–î–µ–º–æ–Ω—Ç–∞–∂ —É–Ω–∏—Ç–∞–∑–∞", "unit": "—à—Ç", "price": 300 },
        { "name": "–î–µ–º–æ–Ω—Ç–∞–∂ –≤–∞–Ω–Ω—ã", "unit": "—à—Ç", "price": 500 },
        { "name": "–î–µ–º–æ–Ω—Ç–∞–∂ —Å–º–µ—Å–∏—Ç–µ–ª—è", "unit": "—à—Ç", "price": 150 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∏—Ä–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã", "unit": "—à—Ç", "price": 1000 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Å—É–¥–æ–º–æ–µ—á–Ω–æ–π –º–∞—à–∏–Ω—ã", "unit": "—à—Ç", "price": 1000 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ—Ä–º–æ—Ä–µ–≥—É–ª—è—Ç–æ—Ä–∞ (—Ç—ë–ø–ª—ã–π –ø–æ–ª)", "unit": "—à—Ç", "price": 650 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–Ω–æ–π –ª–µ–Ω—Ç—ã", "unit": "–º.–ø.", "price": 250 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≥–∞—Ä–¥–∏–Ω—ã", "unit": "—à—Ç", "price": 300 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ–¥–≤–µ—Å–Ω–æ–≥–æ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∞", "unit": "—à—Ç", "price": 500 },
        { "name": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞—Å—Ç–µ–Ω–Ω–æ–≥–æ —Å–≤–µ—Ç–∏–ª—å–Ω–∏–∫–∞", "unit": "—à—Ç", "price": 500 }
      ]
    };

    let currentQuantities = {};
    let activeSection = "–ú–æ–Ω—Ç–∞–∂ –ø–æ—Ç–æ–ª–∫–æ–≤";

    function showSection(sectionName) {
      // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π
      event.target.classList.add('active');
      // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â–∏–π —Ä–∞–∑–¥–µ–ª
      activeSection = sectionName;
      renderWorks();
    }

    function renderWorks() {
      const area = parseFloat(document.getElementById("area").value) || 0;
      const rooms = document.getElementById("rooms").value;
      let html = '';

      if (WORKS_DATA[activeSection]) {
        html += `<div class="section"><div class="section-title">üß± ${activeSection}</div><div class="checkbox-group">`;

        WORKS_DATA[activeSection].forEach((item, idx) => {
          const key = `${activeSection}_${idx}`.replace(/\s+/g, '_').toLowerCase();
          const isSquare = item.unit === "–º¬≤";
          let qty = 0;

          // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è –∫–∞–ø–∏—Ç–∞–ª—å–Ω–æ–≥–æ —Ä–µ–º–æ–Ω—Ç–∞
          if (document.getElementById("repairType").value === "capital") {
            if (isSquare) {
              qty = Math.round(area * 0.8); // 80% –ø–ª–æ—â–∞–¥–∏
            } else if (item.name.includes("–¥–≤–µ—Ä—å")) {
              qty = parseInt(rooms) + 1; // 1 –¥–≤–µ—Ä—å –Ω–∞ –∫–æ–º–Ω–∞—Ç—É + 1 –≤—Ö–æ–¥–Ω–∞—è
            } else if (item.name.includes("—Ä–æ–∑–µ—Ç–∫–∞")) {
              qty = Math.round(area * 0.3); // 0.3 —à—Ç –Ω–∞ –º¬≤
            } else if (item.name.includes("–ª—é—Å—Ç—Ä–∞")) {
              qty = Math.round(area / 20); // 1 —à—Ç –Ω–∞ 20 –º¬≤
            } else {
              qty = 1;
            }
          }

          html += `
            <div class="checkbox-item">
              <label>
                <input type="checkbox" id="work_${key}" onchange="toggleWork('${key}', this.checked, ${item.price}, '${item.unit}')">
                ${item.name}
              </label>
              <div class="price-note">${item.price} ‚ÇΩ / ${item.unit}</div>
              ${isSquare ? `<input type="number" id="qty_${key}" value="${qty}" min="0" onchange="updateQty('${key}', this.value)">` : ''}
            </div>
          `;
        });

        html += '</div></div>';
      }

      document.getElementById("works").innerHTML = html;
      calculate();
    }

    function toggleWork(key, checked, price, unit) {
      const qtyInput = document.getElementById(`qty_${key}`);
      if (checked) {
        const area = parseFloat(document.getElementById("area").value) || 50;
        const rooms = document.getElementById("rooms").value;
        let qty = 1;

        if (unit === "–º¬≤") {
          qty = Math.round(area * 0.8);
        } else if (price <= 1000 && !isNaN(area)) {
          if (key.includes("–¥–≤–µ—Ä—å")) {
            qty = parseInt(rooms) + 1;
          } else if (key.includes("—Ä–æ–∑–µ—Ç–∫–∞")) {
            qty = Math.round(area * 0.3);
          } else if (key.includes("–ª—é—Å—Ç—Ä–∞")) {
            qty = Math.round(area / 20);
          }
        }

        currentQuantities[key] = { qty, price, unit };
        if (qtyInput) qtyInput.value = qty;
      } else {
        currentQuantities[key] = { qty: 0, price, unit };
        if (qtyInput) qtyInput.value = 0;
      }
      calculate();
    }

    function updateQty(key, value) {
      const qty = parseFloat(value) || 0;
      if (currentQuantities[key]) {
        currentQuantities[key].qty = qty;
      }
      calculate();
    }

    function calculate() {
      let total = 0;
      Object.values(currentQuantities).forEach(item => {
        if (item.qty > 0) {
          total += item.qty * item.price;
        }
      });
      const formatted = new Intl.NumberFormat('ru-RU').format(total);
      document.getElementById("result").innerText = `–ò—Ç–æ–≥–æ: ${formatted} ‚ÇΩ`;
    }

    function sendData() {
      const details = [];
      let totalSum = 0;

      Object.entries(currentQuantities).forEach(([key, item]) => {
        if (item.qty > 0) {
          const label = document.querySelector(`label[for="work_${key}"]`);
          const name = label ? label.textContent.trim().replace(/\s*\d+ ‚ÇΩ.*$/, '') : key;
          const lineTotal = item.qty * item.price;
          details.push(`${item.qty} ${item.unit} √ó ${item.price} ‚ÇΩ = ${lineTotal} ‚ÇΩ ‚Äî ${name}`);
          totalSum += lineTotal;
        }
      });

      if (details.length === 0) {
        alert("–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Ä–∞–±–æ—Ç—É.");
        return;
      }

      // –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
      const area = document.getElementById("area").value;
      const rooms = document.getElementById("rooms").value;
      const repairType = document.getElementById("repairType").value;
      const date = new Date().toLocaleString('ru-RU');

      const textContent = `
üìå –°–º–µ—Ç–∞ –æ—Ç ${date}
üè† –ü–ª–æ—â–∞–¥—å: ${area} –º¬≤ | –ö–æ–º–Ω–∞—Ç–∞: ${rooms} | –¢–∏–ø —Ä–µ–º–æ–Ω—Ç–∞: ${repairType}

üìã –†–∞–±–æ—Ç—ã:
${details.join('\n')}

üí∞ –ò—Ç–æ–≥–æ: ${new Intl.NumberFormat('ru-RU').format(totalSum)} ‚ÇΩ

---
–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
      `;

      const blob = new Blob([textContent], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `—Å–º–µ—Ç–∞_${date.replace(/[:\s]/g, '_')}.txt`;
      a.click();

      // –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
      const WebApp = window.Telegram.WebApp;
      WebApp.sendData(JSON.stringify({
        area: area,
        rooms: rooms,
        repairType: repairType,
        total: totalSum,
        details: details
      }));
      WebApp.close();
    }

    function callMaster() {
      window.Telegram.WebApp.openTelegramLink("https://t.me/grigorii_saveliev");
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    document.getElementById("area").addEventListener("input", renderWorks);
    document.getElementById("rooms").addEventListener("change", renderWorks);
    document.getElementById("repairType").addEventListener("change", renderWorks);
    renderWorks();
  </script>
</body>
</html>