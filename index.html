<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { padding: 20px; font-family: sans-serif; }
        button { 
            width: 100%; height: 60px; background: red; color: white; 
            font-size: 20px; border: none; border-radius: 10px; 
        }
    </style>
</head>
<body>
    <h1>ПРОВЕРКА СВЯЗИ</h1>
    <p>Нажми кнопку ниже. Должно закрыться окно.</p>
    
    <button onclick="sendTest()">ОТПРАВИТЬ ТЕСТ</button>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        function sendTest() {
            // 1. Показываем сообщение перед отправкой
            alert("Попытка отправки...");

            try {
                // 2. Формируем данные
                const data = JSON.stringify({
                    area: "100",
                    total: "TEST_SUM",
                    items: []
                });

                // 3. Отправляем
                tg.sendData(data);
                
                // 4. Закрываем (чтобы понять, что сработало)
                // tg.close(); // Пока не закрываем, чтобы видеть результат
                
            } catch (e) {
                alert("Ошибка: " + e.message);
            }
        }
    </script>
</body>
</html>