<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–µ–º–æ–Ω—Ç–∞</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* –¢–≤–æ–π –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π CSS */
    :root { --primary: #d35400; --primary-dark: #a04000; --bg: #fdf6f0; --text: #2c3e50; --card-bg: #fff; }
    body { font-family: 'Inter', sans-serif; background: var(--bg); padding: 16px; margin: 0; color: var(--text); }
    .card { background: var(--card-bg); border-radius: 20px; padding: 24px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
    h2 { text-align: center; color: var(--text); }
    label { display: block; margin: 15px 0 5px; font-weight: 600; }
    input, select { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 12px; font-size: 16px; box-sizing: border-box; }
    
    .checkbox-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #eee; }
    .price-note { font-size: 12px; color: #7f8c8d; }
    input[type="checkbox"] { width: 22px; height: 22px; accent-color: var(--primary); }
    
    #result { font-size: 22px; font-weight: bold; color: var(--primary); text-align: center; margin: 20px 0; padding: 15px; background: #fff3e0; border-radius: 12px; }
    
    button { background: var(--primary); color: white; border: none; padding: 18px; border-radius: 14px; font-size: 18px; width: 100%; font-weight: 600; cursor: pointer; }
    button:active { background: var(--primary-dark); }
  </style>
</head>
<body>
  <div class="card">
    <h2>–†–∞—Å—á—ë—Ç —Ä–µ–º–æ–Ω—Ç–∞</h2>

    <label>–ü–ª–æ—â–∞–¥—å (–º¬≤):</label>
    <input type="number" id="area" value="50" oninput="calculate()">

    <label>–ö–æ–º–Ω–∞—Ç—ã:</label>
    <select id="rooms">
      <option value="1">1-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
      <option value="2" selected>2-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
      <option value="3">3-–∫–æ–º–Ω–∞—Ç–Ω–∞—è</option>
    </select>
    
    <label>–¢–∏–ø:</label>
    <select id="repairType">
      <option>–ö–æ—Å–º–µ—Ç–∏—á–µ—Å–∫–∏–π</option>
      <option selected>–ö–∞–ø–∏—Ç–∞–ª—å–Ω—ã–π</option>
      <option>–ï–≤—Ä–æ</option>
    </select>

    <h3>–†–∞–±–æ—Ç—ã:</h3>
    <div id="works-list">
        </div>

    <div id="result">–ò—Ç–æ–≥–æ: 0 ‚ÇΩ</div>

    <button onclick="sendData()">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—á—ë—Ç</button>
  </div>

  <script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    // –î–∞–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç
    const WORKS = [
        { id: "w1", name: "–®–ø–∞—Ç–ª–µ–≤–∫–∞ —Å—Ç–µ–Ω", price: 470 },
        { id: "w2", name: "–ü–æ–∫—Ä–∞—Å–∫–∞ —Å—Ç–µ–Ω", price: 450 },
        { id: "w3", name: "–ü–ª–∏—Ç–∫–∞ (—É–∫–ª–∞–¥–∫–∞)", price: 3000 },
        { id: "w4", name: "–≠–ª–µ–∫—Ç—Ä–∏–∫–∞ (—Ç–æ—á–∫–∏)", price: 500 },
        { id: "w5", name: "–°—Ç—è–∂–∫–∞ –ø–æ–ª–∞", price: 900 }
    ];

    // –†–µ–Ω–¥–µ—Ä —Å–ø–∏—Å–∫–∞
    const listEl = document.getElementById("works-list");
    WORKS.forEach(w => {
        listEl.innerHTML += `
        <div class="checkbox-item">
            <div>
                <div>${w.name}</div>
                <div class="price-note">${w.price} ‚ÇΩ/–º¬≤</div>
            </div>
            <input type="checkbox" id="${w.id}" onchange="calculate()" checked>
        </div>`;
    });

    function calculate() {
        const area = parseFloat(document.getElementById('area').value) || 0;
        let total = 0;
        
        WORKS.forEach(w => {
            if(document.getElementById(w.id).checked) {
                total += w.price * area;
            }
        });
        
        document.getElementById('result').innerText = `–ò—Ç–æ–≥–æ: ${total.toLocaleString()} ‚ÇΩ`;
        return total;
    }

    function sendData() {
        const area = document.getElementById('area').value;
        const rooms = document.getElementById('rooms').value;
        const type = document.getElementById('repairType').value;
        const totalSum = document.getElementById('result').innerText;
        
        let details = [];
        WORKS.forEach(w => {
            if(document.getElementById(w.id).checked) {
                details.push(`${w.name} (${w.price}—Ä * ${area}–º)`);
            }
        });

        const data = {
            area: area,
            rooms: rooms,
            repairType: type,
            total: totalSum,
            details: details
        };

        tg.sendData(JSON.stringify(data));
    }
    
    calculate();
  </script>
</body>
</html>